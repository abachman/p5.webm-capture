(()=>{var X=function(e,t,i){var n=window,h="application/octet-stream",p=i||h,w=e,T=!t&&!i&&w,g=document.createElement("a"),d=function(s){return String(s)},a=n.Blob||n.MozBlob||n.WebKitBlob||d,m=t||"download",u,y;if(a=a.call?a.bind(n):Blob,String(this)==="true"&&(w=[w,p],p=w[0],w=w[1]),T&&T.length<2048&&(m=T.split("/").pop().split("?")[0],g.href=T,g.href.indexOf(T)!==-1)){var k=new XMLHttpRequest;return k.open("GET",T,!0),k.responseType="blob",k.onload=function(s){X(s.target.response,m,h)},setTimeout(function(){k.send()},0),k}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(w))if(w.length>1024*1024*1.999&&a!==d)w=B(w),p=w.type||h;else return navigator.msSaveBlob?navigator.msSaveBlob(B(w),m):C(w);else if(/([\x80-\xff])/.test(w)){var E=0,L=new Uint8Array(w.length),I=L.length;for(E;E<I;++E)L[E]=w.charCodeAt(E);w=new a([L],{type:p})}u=w instanceof a?w:new a([w],{type:p});function B(s){var b=s.split(/[:;,]/),M=b[1],S=s.indexOf("charset")>0?3:2,P=b[S]=="base64"?atob:decodeURIComponent,R=P(b.pop()),z=R.length,D=0,O=new Uint8Array(z);for(D;D<z;++D)O[D]=R.charCodeAt(D);return new a([O],{type:M})}function C(s,b){if("download"in g)return g.href=s,g.setAttribute("download",m),g.className="download-js-link",g.innerHTML="downloading...",g.style.display="none",g.addEventListener("click",function(S){S.stopPropagation(),this.removeEventListener("click",arguments.callee)}),document.body.appendChild(g),setTimeout(function(){g.click(),document.body.removeChild(g),b===!0&&setTimeout(function(){n.URL.revokeObjectURL(g.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(s)&&(s="data:"+s.replace(/^data:([\w\/\-\+]+)/,h)),window.open(s)||confirm("Displaying New Document. Use Save As... to download, then click back to return to this page.")&&(location.href=s),!0;var M=document.createElement("iframe");document.body.appendChild(M),!b&&/^data:/.test(s)&&(s="data:"+s.replace(/^data:([\w\/\-\+]+)/,h)),M.src=s,setTimeout(function(){document.body.removeChild(M)},333)}return C(n.URL.createObjectURL(u),!0),!0};var G=class{constructor(t){this.data=new Uint8Array(t),this.pos=0}seek(t){this.pos=t}writeBytes(t){for(let i=0;i<t.length;i++)this.data[this.pos++]=t[i]}writeByte(t){this.data[this.pos++]=t}writeU16BE(t){this.data[this.pos++]=t>>8,this.data[this.pos++]=t}writeDoubleBE(t){let i=new Uint8Array(new Float64Array([t]).buffer);for(let n=i.length-1;n>=0;n--)this.writeByte(i[n])}writeFloatBE(t){let i=new Uint8Array(new Float32Array([t]).buffer);for(let n=i.length-1;n>=0;n--)this.writeByte(i[n])}writeString(t){for(let i=0;i<t.length;i++)this.data[this.pos++]=t.charCodeAt(i)}writeEBMLVarIntWidth(t,i){switch(i){case 1:this.writeU8(1<<7|t);break;case 2:this.writeU8(1<<6|t>>8),this.writeU8(t);break;case 3:this.writeU8(1<<5|t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 4:this.writeU8(1<<4|t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 5:this.writeU8(1<<3|t/4294967296&7),this.writeU8(t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;default:throw new Error("Bad EBML VINT size "+i)}}measureEBMLVarInt(t){if(t<(1<<7)-1)return 1;if(t<(1<<14)-1)return 2;if(t<(1<<21)-1)return 3;if(t<(1<<28)-1)return 4;if(t<34359738367)return 5;throw new Error("EBML VINT size not supported "+t)}writeEBMLVarInt(t){this.writeEBMLVarIntWidth(t,this.measureEBMLVarInt(t))}writeUnsignedIntBE(t,i){switch(i===void 0&&(i=this.measureUnsignedInt(t)),i){case 5:this.writeU8(Math.floor(t/4294967296));case 4:this.writeU8(t>>24);case 3:this.writeU8(t>>16);case 2:this.writeU8(t>>8);case 1:this.writeU8(t);break;default:throw new Error("Bad UINT size "+i)}}measureUnsignedInt(t){return t<1<<8?1:t<1<<16?2:t<1<<24?3:t<4294967296?4:5}getAsDataArray(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw new Error("ArrayBufferDataStream's pos lies beyond end of buffer")}};G.prototype.writeU8=G.prototype.writeByte;var nt=function(e){return function(t){let i=[],n=Promise.resolve(),h=null,p=null;t&&t.constructor.name==="FileWriter"?h=t:e&&t&&(p=t),this.pos=0,this.length=0;function w(d){return new Promise(function(a,m){let u=new FileReader;u.addEventListener("loadend",function(){a(u.result)}),u.readAsArrayBuffer(d)})}function T(d){return new Promise(function(a,m){d instanceof Uint8Array?a(d):d instanceof ArrayBuffer||ArrayBuffer.isView(d)?a(new Uint8Array(d)):d instanceof Blob?a(w(d).then(function(u){return new Uint8Array(u)})):a(w(new Blob([d])).then(function(u){return new Uint8Array(u)}))})}function g(d){let a=d.byteLength||d.length||d.size;if(!Number.isInteger(a))throw new Error("Failed to determine size of element");return a}this.seek=function(d){if(d<0)throw new Error("Offset may not be negative");if(isNaN(d))throw new Error("Offset may not be NaN");if(d>this.length)throw new Error("Seeking beyond the end of file is not allowed");this.pos=d},this.write=function(d){let a={offset:this.pos,data:d,length:g(d)},m=a.offset>=this.length;this.pos+=a.length,this.length=Math.max(this.length,this.pos),n=n.then(function(){if(p)return new Promise(function(u,y){T(a.data).then(function(k){let E=0,L=Buffer.from(k.buffer),I=function(B,C,s){E+=C,E>=s.length?u():e.write(p,s,E,s.length-E,a.offset+E,I)};e.write(p,L,0,L.length,a.offset,I)})});if(h)return new Promise(function(u,y){h.onwriteend=u,h.seek(a.offset),h.write(new Blob([a.data]))});if(!m)for(let u=0;u<i.length;u++){let y=i[u];if(!(a.offset+a.length<=y.offset||a.offset>=y.offset+y.length)){if(a.offset<y.offset||a.offset+a.length>y.offset+y.length)throw new Error("Overwrite crosses blob boundaries");if(a.offset==y.offset&&a.length==y.length){y.data=a.data;return}else return T(y.data).then(function(k){return y.data=k,T(a.data)}).then(function(k){a.data=k,y.data.set(a.data,a.offset-y.offset)})}}i.push(a)})},this.complete=function(d){return p||h?n=n.then(function(){return null}):n=n.then(function(){let a=[];for(let m=0;m<i.length;m++)a.push(i[m].data);return new Blob(a,{type:d})}),n}}};function yt(e,t){let i={};return[e,t].forEach(function(n){for(let h in n)Object.prototype.hasOwnProperty.call(n,h)&&(i[h]=n[h])}),i}function bt(e){if(typeof e!="string"||!e.match(/^data:image\/webp;base64,/i))throw new Error("Failed to decode WebP Base64 URL");return window.atob(e.substring("data:image/webp;base64,".length))}function ot(e,t){let i=typeof e=="string"&&/^data:image\/webp/.test(e)?e:e.toDataURL("image/webp",t);return bt(i)}function Bt(e){let t=e.charCodeAt(0),i=e.charCodeAt(1),n=e.charCodeAt(2),h=e.charCodeAt(3);return(t|i<<8|n<<16|h<<24)>>>0}function st(e){let t=e.indexOf("VP8",12);if(t===-1)throw new Error("Bad image format, does this browser support WebP?");let i=!1;for(;t<e.length-8;){let n,h;switch(h=e.substring(t,t+4),t+=4,n=Bt(e.substring(t,t+4)),t+=4,h){case"VP8 ":return{frame:e.substring(t,t+n),hasAlpha:i};case"ALPH":i=!0;break}t+=n,(n&1)!==0&&t++}throw new Error("Failed to find VP8 keyframe in WebP image, is this image mistakenly encoded in the Lossless WebP format?")}function xt(e){this.value=e}function dt(e){this.value=e}function V(e,t,i){if(Array.isArray(i))for(let n=0;n<i.length;n++)V(e,t,i[n]);else if(typeof i=="string")e.writeString(i);else if(i instanceof Uint8Array)e.writeBytes(i);else if(i.id)if(i.offset=e.pos+t,e.writeUnsignedIntBE(i.id),Array.isArray(i.data)){let n,h,p;i.size===-1?e.writeByte(255):(n=e.pos,e.writeBytes([0,0,0,0])),h=e.pos,i.dataOffset=h+t,V(e,t,i.data),i.size!==-1&&(p=e.pos,i.size=p-h,e.seek(n),e.writeEBMLVarIntWidth(i.size,4),e.seek(p))}else if(typeof i.data=="string")e.writeEBMLVarInt(i.data.length),i.dataOffset=e.pos+t,e.writeString(i.data);else if(typeof i.data=="number")i.size||(i.size=e.measureUnsignedInt(i.data)),e.writeEBMLVarInt(i.size),i.dataOffset=e.pos+t,e.writeUnsignedIntBE(i.data,i.size);else if(i.data instanceof dt)e.writeEBMLVarInt(8),i.dataOffset=e.pos+t,e.writeDoubleBE(i.data.value);else if(i.data instanceof xt)e.writeEBMLVarInt(4),i.dataOffset=e.pos+t,e.writeFloatBE(i.data.value);else if(i.data instanceof Uint8Array)e.writeEBMLVarInt(i.data.byteLength),i.dataOffset=e.pos+t,e.writeBytes(i.data);else throw new Error("Bad EBML datatype "+typeof i.data);else throw new Error("Bad EBML datatype "+typeof i.data)}var vt=function(e,t){return function(i){let n=5e3,h=1,p=!1,w=0,T=0,g=null,d=null,a=null,m=[],u=0,y=0,k={quality:.95,transparent:!1,alphaQuality:void 0,fileWriter:null,fd:null,frameDuration:null,frameRate:null},E={Cues:{id:new Uint8Array([28,83,187,107]),positionEBML:null},SegmentInfo:{id:new Uint8Array([21,73,169,102]),positionEBML:null},Tracks:{id:new Uint8Array([22,84,174,107]),positionEBML:null}},L,I={id:17545,data:new dt(0)},B,C=[],s=new t(i.fileWriter||i.fd);function b(r){return r-L.dataOffset}function M(r){(g===null||g.width!==r.width||g.height!==r.height)&&(g=document.createElement("canvas"),g.width=r.width,g.height=r.height,d=g.getContext("2d"),a=d.createImageData(g.width,g.height));let f=r.getContext("2d"),x=f.getImageData(0,0,r.width,r.height).data,c=a.data,A=0,W=r.width*r.height*4;for(let q=3;q<W;q+=4){let H=x[q];c[A++]=H,c[A++]=H,c[A++]=H,c[A++]=255}return d.putImageData(a,0,0),g}function S(){let r={id:21420,size:5,data:0},f={id:290298740,data:[]};for(let x in E){let c=E[x];c.positionEBML=Object.create(r),f.data.push({id:19899,data:[{id:21419,data:c.id},c.positionEBML]})}return f}function P(){B=S();let r={id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]},f={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:"webm-writer-js"},{id:22337,data:"webm-writer-js"},I]},x=[{id:176,data:w},{id:186,data:T}];i.transparent&&x.push({id:21440,data:1});let c={id:374648427,data:[{id:174,data:[{id:215,data:h},{id:29637,data:h},{id:156,data:0},{id:2274716,data:"und"},{id:134,data:"V_VP8"},{id:2459272,data:"VP8"},{id:131,data:1},{id:224,data:x}]}]};L={id:408125543,size:-1,data:[B,f,c]};let A=new e(256);V(A,s.pos,[r,L]),s.write(A.getAsDataArray()),E.SegmentInfo.positionEBML.data=b(f.offset),E.Tracks.positionEBML.data=b(c.offset),p=!0}function R(r){let f,x,c=new e(1+2+1);if(!(r.trackNumber>0&&r.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return c.writeEBMLVarInt(r.trackNumber),c.writeU16BE(r.timecode),c.writeByte(0),f={id:161,data:[c.getAsDataArray(),r.frame]},x={id:30113,data:[{id:166,data:[{id:238,data:1},{id:165,data:r.alpha}]}]},{id:160,data:[f,x]}}function z(r){let f=new e(1+2+1);if(!(r.trackNumber>0&&r.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return f.writeEBMLVarInt(r.trackNumber),f.writeU16BE(r.timecode),f.writeByte(1<<7),{id:163,data:[f.getAsDataArray(),r.frame]}}function D(r){return r.alpha?R(r):z(r)}function O(r){return{id:524531317,data:[{id:231,data:Math.round(r.timecode)}]}}function Z(r,f,x){C.push({id:187,data:[{id:179,data:f},{id:183,data:[{id:247,data:r},{id:241,data:b(x)}]}]})}function $(){let r={id:475249515,data:C},f=new e(16+C.length*32);V(f,s.pos,r),s.write(f.getAsDataArray()),E.Cues.positionEBML.data=b(r.offset)}function K(){if(m.length===0)return;let r=0;for(let c=0;c<m.length;c++)r+=m[c].frame.length+(m[c].alpha?m[c].alpha.length:0);let f=new e(r+m.length*64),x=O({timecode:Math.round(u)});for(let c=0;c<m.length;c++)x.data.push(D(m[c]));V(f,s.pos,x),s.write(f.getAsDataArray()),Z(h,Math.round(u),x.offset),console.log("flushClusterFrameBuffer"),m=[],u+=y,y=0}function j(){if(!i.frameDuration)if(i.frameRate)i.frameDuration=1e3/i.frameRate;else throw new Error("Missing required frameDuration or frameRate setting");i.quality=Math.max(Math.min(i.quality,.99999),0),i.alphaQuality===void 0?i.alphaQuality=i.quality:i.alphaQuality=Math.max(Math.min(i.alphaQuality,.99999),0)}function tt(r){r.trackNumber=h,r.timecode=Math.round(y),m.push(r),y+=r.duration,y>=n&&K()}function Q(){let r=new e(B.size),f=s.pos;V(r,B.dataOffset,B.data),s.seek(B.dataOffset),s.write(r.getAsDataArray()),s.seek(f)}function et(){let r=new e(8),f=s.pos;r.writeDoubleBE(u),s.seek(I.dataOffset),s.write(r.getAsDataArray()),s.seek(f)}this.addFrame=function(r,f,x){p||(w=r.width||0,T=r.height||0,P());let c=st(ot(r,i.quality)),A,W=null;x?A=x:typeof f=="number"?A=f:A=i.frameDuration,i.transparent&&(f instanceof HTMLCanvasElement||typeof f=="string"?W=f:c.hasAlpha&&(W=M(r))),console.log("adding frame to cluster",A,m.length),tt({frame:c.frame,duration:A,alpha:W?st(ot(W,i.alphaQuality)).frame:null})},this.complete=function(){return console.log("webm-writer complete!",s.length),p||P(),K(),$(),Q(),et(),s.complete("video/webm")},this.getWrittenSize=function(){return s.length},i=yt(k,i||{}),j()}},lt=()=>(console.log("createWebMWriter"),new vt(G,nt(null)));var ut=lt();(function(){if("performance"in window||(window.performance={}),!("now"in window.performance)){var e=Date.now();window.performance.now=function(){return Date.now()-e}}})();function ft(e){return String("0000000"+e).slice(-7)}var Et=window.Date.now();function Ct(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function U(e){var t={};this.settings=e,this.on=function(i,n){t[i]=n},this.emit=function(i){var n=t[i];n&&n.apply(null,Array.prototype.slice.call(arguments,1))},this.filename=e.name||Ct(),this.extension="",this.mimeType=""}U.prototype.start=function(){};U.prototype.stop=function(){};U.prototype.add=function(){};U.prototype.save=function(){};U.prototype.dispose=function(){};U.prototype.safeToProceed=function(){return!0};U.prototype.step=function(){console.log("Step not set!")};function N(e){U.call(this,e),this.quality=e.quality/100||.8,this.extension=".webm",this.mimeType="video/webm",this.baseFilename=this.filename,this.framerate=e.framerate,this.frames=0,this.part=1,this.videoWriter=new ut({quality:this.quality,fileWriter:null,fd:null,frameRate:this.framerate})}N.prototype=Object.create(U.prototype);N.prototype.start=function(e){this.dispose()};N.prototype.add=function(e){this.videoWriter.addFrame(e),this.settings.autoSaveTime>0&&this.frames/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(t){this.filename=this.baseFilename+"-part-"+ft(this.part),X(t,this.filename+this.extension,this.mimeType),this.dispose(),this.part++,this.filename=this.baseFilename+"-part-"+ft(this.part),this.step()}.bind(this)):(this.frames++,this.step())};N.prototype.save=function(e){this.videoWriter.complete().then(e)};N.prototype.dispose=function(e){this.frames=0,this.videoWriter=new ut({quality:this.quality,fileWriter:null,fd:null,frameRate:this.framerate})};function J(e){U.call(this,e),this.framerate=this.settings.framerate,this.type="video/webm",this.extension=".webm",this.stream=null,this.mediaRecorder=null,this.chunks=[]}J.prototype=Object.create(U.prototype);J.prototype.add=function(e){this.stream||(this.stream=e.captureStream(this.framerate),this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=function(t){this.chunks.push(t.data)}.bind(this)),this.step()};J.prototype.save=function(e){this.mediaRecorder.onstop=function(t){var i=new Blob(this.chunks,{type:"video/webm"});this.chunks=[],e(i)}.bind(this),this.mediaRecorder.stop()};function it(e){U.call(this,e),e.quality=31-(e.quality*30/100||10),e.workers=e.workers||4,this.extension=".gif",this.mimeType="image/gif",this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.sizeSet=!1,this.encoder=new GIF({workers:e.workers,quality:e.quality,workerScript:e.workersPath+"gif.worker.js"}),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("finished",function(t){var i=this.callback;i&&(this.callback=void 0,i(t))}.bind(this))}it.prototype=Object.create(U.prototype);it.prototype.add=function(e){this.sizeSet||(this.encoder.setOption("width",e.width),this.encoder.setOption("height",e.height),this.sizeSet=!0),this.canvas.width=e.width,this.canvas.height=e.height,this.ctx.drawImage(e,0,0),this.encoder.addFrame(this.ctx,{copy:!0,delay:this.settings.step}),this.step()};it.prototype.save=function(e){this.callback=e,this.encoder.render()};function ct(e){var t=e||{},i=new Date,n,h,p,w,T,g,c,d,a=[],m=[],u=0,y=0,k=null,E=[],L=!1,I={};t.framerate=t.framerate||60,t.motionBlurFrames=2*(t.motionBlurFrames||1),n=t.verbose||!1,h=t.display||!1,t.step=1e3/t.framerate,t.timeLimit=t.timeLimit||0,t.frameLimit=t.frameLimit||0,t.startTime=t.startTime||0;var B=document.createElement("div");B.style.position="absolute",B.style.left=B.style.top=0,B.style.backgroundColor="black",B.style.fontFamily="monospace",B.style.fontSize="11px",B.style.padding="5px",B.style.color="red",B.style.zIndex=1e5,t.display&&document.body.appendChild(B);var C=document.createElement("canvas"),s=C.getContext("2d"),b,M;_("Step is set to "+t.step+"ms");var S={webm:N,"webm-mediarecorder":J},P=S[t.format];if(!P)throw"Error: Incorrect or missing format: Valid formats are "+Object.keys(S).join(", ");if(d=new P(t),d.step=c,d.on("process",rt),d.on("progress",gt),"performance"in window||(window.performance={}),Date.now=Date.now||function(){return new Date().getTime()},!("now"in window.performance)){var R=Date.now();performance.timing&&performance.timing.navigationStart&&(R=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-R}}var z=window.setTimeout,D=window.setInterval,O=window.clearInterval,Z=window.clearTimeout,$=window.requestAnimationFrame,K=window.Date.now,j=window.performance.now,tt=window.Date.prototype.getTime,Q=[];function et(){_("Capturer start"),w=window.Date.now(),p=w+t.startTime,g=window.performance.now(),T=g+t.startTime,window.Date.prototype.getTime=function(){return p},window.Date.now=function(){return p},window.setTimeout=function(o,v){var F={callback:o,time:v,triggerTime:p+v};return a.push(F),_("Timeout set to "+F.time),F},window.clearTimeout=function(o){for(var v=0;v<a.length;v++)if(a[v]==o){a.splice(v,1),_("Timeout cleared");continue}},window.setInterval=function(o,v){var F={callback:o,time:v,triggerTime:p+v};return m.push(F),_("Interval set to "+F.time),F},window.clearInterval=function(o){return _("clear Interval"),null},window.requestAnimationFrame=function(o){E.push(o)},window.performance.now=function(){return T};function l(){return this._hooked||(this._hooked=!0,this._hookedTime=this.currentTime||0,this.pause(),Q.push(this)),this._hookedTime+t.startTime}try{Object.defineProperty(HTMLVideoElement.prototype,"currentTime",{get:l}),Object.defineProperty(HTMLAudioElement.prototype,"currentTime",{get:l})}catch(o){_(o)}}function r(){et(),d.start(),L=!0}function f(){L=!1,d.stop(),A()}function x(l,o){z(l,0,o)}function c(){x(rt)}function A(){_("Capturer stop"),window.setTimeout=z,window.setInterval=D,window.clearInterval=O,window.clearTimeout=Z,window.requestAnimationFrame=$,window.Date.prototype.getTime=tt,window.Date.now=K,window.performance.now=j}function W(){var l=u/t.framerate;(t.frameLimit&&u>=t.frameLimit||t.timeLimit&&l>=t.timeLimit)&&(f(),at());var o=new Date(null);o.setSeconds(l),t.motionBlurFrames>2?B.textContent="CCapture "+t.format+" | "+u+" frames ("+y+" inter) | "+o.toISOString().substr(11,8):B.textContent="CCapture "+t.format+" | "+u+" frames | "+o.toISOString().substr(11,8)}function q(l){(C.width!==l.width||C.height!==l.height)&&(C.width=l.width,C.height=l.height,b=new Uint16Array(C.height*C.width*4),s.fillStyle="#0",s.fillRect(0,0,C.width,C.height))}function H(l){s.drawImage(l,0,0),M=s.getImageData(0,0,C.width,C.height);for(var o=0;o<b.length;o+=4)b[o]+=M.data[o],b[o+1]+=M.data[o+1],b[o+2]+=M.data[o+2];y++}function ht(){for(var l=M.data,o=0;o<b.length;o+=4)l[o]=b[o]*2/t.motionBlurFrames,l[o+1]=b[o+1]*2/t.motionBlurFrames,l[o+2]=b[o+2]*2/t.motionBlurFrames;s.putImageData(M,0,0),d.add(C),u++,y=0,_("Full MB Frame! "+u+" "+p);for(var o=0;o<b.length;o+=4)b[o]=0,b[o+1]=0,b[o+2]=0;gc()}function mt(l){L&&(t.motionBlurFrames>2?(q(l),H(l),y>=.5*t.motionBlurFrames?ht():c()):(d.add(l),u++,_("Full Frame! "+u)))}function rt(){var l=1e3/t.framerate,o=(u+y/t.motionBlurFrames)*l;p=w+o,T=g+o,Q.forEach(function(F){F._hookedTime=o/1e3}),W(),_("Frame: "+u+" "+y);for(var v=0;v<a.length;v++)if(p>=a[v].triggerTime){x(a[v].callback),a.splice(v,1);continue}for(var v=0;v<m.length;v++)if(p>=m[v].triggerTime){x(m[v].callback),m[v].triggerTime+=m[v].time;continue}E.forEach(function(F){x(F,p-Et)}),E=[]}function at(l){l||(l=function(o){return X(o,d.filename+d.extension,d.mimeType),!1}),d.save(l)}function _(l){n&&console.log(l)}function pt(l,o){I[l]=o}function wt(l){var o=I[l];o&&o.apply(null,Array.prototype.slice.call(arguments,1))}function gt(l){wt("progress",l)}return{start:r,capture:mt,stop:f,save:at,on:pt}}var Y=class{constructor(){this.active=!1,this.running=!1}enableCapture({frameCount:t,element:i,onComplete:n}){this.active=!0,this.el=i,this.maxFrames=t,this.frames=0,this.capture=ct({framerate:60,format:"webm",verbose:!1}),this.onComplete=n||function(){}}captureFrame(){this.active&&!this.running&&(this.capture.start(),this.running=!0),this.active&&(this.capture.capture(this.el),this.frames++,this.frames>this.maxFrames&&(this.capture.stop(),this.capture.save(),this.onComplete()))}};if(window){let e=new Y;window.enableCapture=e.enableCapture.bind(e),window.captureFrame=e.captureFrame.bind(e)}})();
// @license http://opensource.org/licenses/MIT
//# sourceMappingURL=p5.webm-capture.js.map
